<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>BharatComfort – Details</title>
<style>
  body{margin:0;font-family:Arial,system-ui;background:#121212;color:#fff}
  header{padding:18px 20px;background:#000;font-weight:700;text-align:center}
  .wrap{max-width:900px;margin:0 auto;padding:20px}
  .card{background:#1e1e1e;border-radius:12px;padding:18px;box-shadow:0 4px 12px rgba(0,0,0,.6)}
  h2{margin:8px 0 10px;color:#FFD700}
  .lead{opacity:.85}
  ul{margin:8px 0 0 18px}
  .img{width:100%;height:280px;border-radius:12px;object-fit:cover;background:#0f0f0f;margin-bottom:12px}
  .btn{display:inline-block;margin-top:12px;padding:10px 14px;background:#FFD700;color:#000;border-radius:8px;text-decoration:none;font-weight:700}
  .btn:hover{background:#e6c200}
</style>
</head>
<body>
<header>BharatComfort</header>

<div class="wrap">
  <div class="card" id="card">Loading…</div>
</div>

<script>
  async function run(){
    const params = new URLSearchParams(location.search);
    const city = params.get('city');
    const type = params.get('type'); // 'hotels' | 'restaurants'
    const id = parseInt(params.get('id'),10);

    if(!city || !type || isNaN(id)){ document.getElementById('card').textContent='Invalid link.'; return; }

    try{
      const res = await fetch('listings.json');
      const DATA = await res.json();
      const arr = (DATA[city] && DATA[city][type]) ? DATA[city][type] : [];
      const item = arr[id];
      if(!item){ document.getElementById('card').textContent='No details found.'; return; }

      const img = item.image || 'assets/images/placeholder.jpg';
      const isHotel = type === 'hotels';
      const extras = isHotel
        ? `
          ${item.rooms ? `<h3>Room Types</h3><ul>${item.rooms.map(r=>`<li>${r.type} — ${r.price}</li>`).join('')}</ul>`:''}
          ${item.services ? `<h3>Services</h3><ul>${item.services.map(s=>`<li>${s}</li>`).join('')}</ul>`:''}
        `
        : `
          ${item.menu ? `<h3>Popular Menu</h3><ul>${item.menu.map(m=>`<li>${m}</li>`).join('')}</ul>`:''}
        `;

      document.getElementById('card').innerHTML = `
        <img class="img" src="${img}" alt="${item.name}">
        <h2>${item.name}</h2>
        <p class="lead"><strong>Address:</strong> ${item.address||'-'}</p>
        <p class="lead"><strong>Price:</strong> ${item.price||'-'}</p>
        ${extras}
        ${item.link ? `<a class="btn" href="${item.link}" target="_blank" rel="noopener">Visit Official Page</a>`:''}
        <div style="margin-top:14px"><a class="btn" href="listings.html?city=${encodeURIComponent(city)}&type=${encodeURIComponent(type)}">Back to ${type==='hotels'?'Hotels':'Restaurants'}</a></div>
      `;
    }catch(e){
      document.getElementById('card').textContent='Error loading details.';
    }
  }
  run();
</script>
</body>
</html>
